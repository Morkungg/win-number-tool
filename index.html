<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>วินเลข</title>
  <style>
    body {
      background: black;
      color: white;
      font-family: sans-serif;
      padding: 20px;
      text-align: center;
    }
    input[type="text"] {
      font-size: 20px;
      padding: 5px;
      width: 100px;
      text-align: center;
    }
    button {
      font-size: 16px;
      margin-left: 5px;
      cursor: pointer;
    }
    .group {
      margin: 20px 0;
    }
    .output {
      background: white;
      color: black;
      padding: 10px;
      margin-top: 5px;
    }
    .green { color: #00FF00; font-weight: bold; }
    .red { color: #FF5555; font-weight: bold; }
    .copy-btn {
      background: #007bff;
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 10px;
    }
    .reset-btn {
      background: #e74c3c;
      color: white;
      padding: 4px 10px;
      border: none;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <h2>โปรแกรมวินเลข จากหน้าไปหลัง</h2>
  <input id="inputDigits" maxlength="10" />
  <button onclick="resetInput()" class="reset-btn">Reset</button>

  <div id="original" class="group"></div>

  <div class="group">
    <span>เลข <b class="green">2 ตัว ไม่รวมเบิ้ล</b></span>
    <button onclick="copyText('twoNoDouble')" class="copy-btn">คัดลอก</button>
    <div id="twoNoDouble" class="output"></div>
  </div>

  <div class="group">
    <span>เลข <b class="red">2 ตัว รวมเบิ้ล</b></span>
    <button onclick="copyText('twoWithDouble')" class="copy-btn">คัดลอก</button>
    <div id="twoWithDouble" class="output"></div>
  </div>

  <div class="group">
    <span>เลข <b class="green">3 ตัว ไม่รวมเบิ้ล</b></span>
    <button onclick="copyText('threeNoDouble')" class="copy-btn">คัดลอก</button>
    <div id="threeNoDouble" class="output"></div>
  </div>

  <div class="group">
    <span>เลข <b class="red">3 ตัว รวมเบิ้ล</b></span>
    <button onclick="copyText('threeWithDouble')" class="copy-btn">คัดลอก</button>
    <div id="threeWithDouble" class="output"></div>
  </div>

  <script>
    const input = document.getElementById("inputDigits");
    const original = document.getElementById("original");

    input.addEventListener("input", generate);

    function resetInput() {
      input.value = "";
      generate();
    }

    function copyText(id) {
      const text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text);
    }

    function unique(arr) {
      return [...new Set(arr)];
    }

    function combinations(arr, k) {
      const result = [];
      const recurse = (start, comb) => {
        if (comb.length === k) {
          result.push(comb);
          return;
        }
        for (let i = start; i < arr.length; i++) {
          recurse(i + 1, comb + arr[i]);
        }
      };
      recurse(0, "");
      return result;
    }

    function combinationsWithReplacement(arr, k) {
      const result = [];
      const recurse = (start, comb) => {
        if (comb.length === k) {
          result.push(comb);
          return;
        }
        for (let i = start; i < arr.length; i++) {
          recurse(i, comb + arr[i]);
        }
      };
      recurse(0, "");
      return result;
    }

    function permutations(arr, k) {
      const result = [];
      const used = [];
      const recurse = (path) => {
        if (path.length === k) {
          result.push(path);
          return;
        }
        for (let i = 0; i < arr.length; i++) {
          if (!used[i]) {
            used[i] = true;
            recurse(path + arr[i]);
            used[i] = false;
          }
        }
      };
      recurse("");
      return result;
    }

    function generate() {
      const raw = input.value.replace(/\D/g, "");
      const digits = unique(raw.split("")).sort();
      original.innerHTML = raw ? `<h3>เลขตั้งต้น</h3><div>${raw}</div>` : "";

      // 2 ตัว
      const twoNoDouble = combinations(digits, 2);
      const twoWithDouble = combinationsWithReplacement(digits, 2);

      // 3 ตัว ไม่รวมเบิ้ล
      const threeNoDouble = permutations(digits, 3).filter(n => {
        return (new Set(n.split(""))).size === 3;
      });

      // 3 ตัว รวมเบิ้ล + ตอง
      let threeWithDoubleSet = new Set();
      const tripletComb = combinationsWithReplacement(digits, 3);
      for (let c of tripletComb) {
        const chars = c.split("");
        const perms = permutations(chars, 3);
        for (let p of perms) {
          if (p[0] <= p[1] && p[1] <= p[2]) {
            threeWithDoubleSet.add(p);
          }
        }
      }
      // เพิ่มเลขตอง
      digits.forEach(d => threeWithDoubleSet.add(d + d + d));

      // แสดงผล
      document.getElementById("twoNoDouble").innerText = twoNoDouble.join(", ");
      document.getElementById("twoWithDouble").innerText = twoWithDouble.join(", ");
      document.getElementById("threeNoDouble").innerText = unique(threeNoDouble).join(", ");
      document.getElementById("threeWithDouble").innerText = Array.from(threeWithDoubleSet).sort().join(", ");
    }
  </script>
</body>
</html>
